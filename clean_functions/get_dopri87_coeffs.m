function [c, A, b, b_star] = get_dopri87_coeffs()
% Returns the coefficients for the Dormand-Prince 8(7) method.
% Coefficients transcribed from the provided FORTRAN RKCO routine,
% mapping FOXY variables A, B, C, D to standard c, A, b, b_star.
% FOXY A -> c (nodes)
% FOXY B -> A (matrix)
% FOXY C -> b (8th order weights)
% FOXY D -> b_star (7th order weights for error)

    s = 13; % Number of stages

    % Nodes c (FOXY A array) - Indices 1 to 13
    c = zeros(s, 1); % c(1) is typically 0
    c(2)  =              1.0 /          18.0;
    c(3)  =              1.0 /          12.0;
    c(4)  =              1.0 /           8.0;
    c(5)  =              5.0 /          16.0;
    c(6)  =              3.0 /           8.0;
    c(7)  =             59.0 /         400.0;
    c(8)  =             93.0 /         200.0;
    c(9)  =     5490023248.0 /  9719169821.0;
    c(10) =             13.0 /          20.0;
    c(11) =     1201146811.0 /  1299019798.0;
    c(12) =            1.0;
    c(13) =            1.0;

    % Matrix A (FOXY B array) - A(i, j) corresponds to B(i, j) where i > j
    A = zeros(s, s); % A(i,j) is coeff for k_j in stage i
    A(2,1) =             1.0 /          18.0;
    A(3,1) =             1.0 /          48.0;
    A(3,2) =             1.0 /          16.0;
    A(4,1) =             1.0 /          32.0;
    % A(4,2) = 0.0; % Explicitly zero
    A(4,3) =             3.0 /          32.0;
    A(5,1) =             5.0 /          16.0;
    % A(5,2) = 0.0;
    A(5,3) = -          75.0 /          64.0;
    A(5,4) =            75.0 /          64.0;
    A(6,1) =             3.0 /          80.0;
    % A(6,2) = 0.0;
    % A(6,3) = 0.0;
    A(6,4) =             3.0 /          16.0;
    A(6,5) =             3.0 /          20.0;
    A(7,1) =      29443841.0 /   614563906.0;
    % A(7,2) = 0.0;
    % A(7,3) = 0.0;
    A(7,4) =      77736538.0 /   692538347.0;
    A(7,5) = -    28693883.0 /  1125000000.0;
    A(7,6) =      23124283.0 /  1800000000.0;
    A(8,1) =      16016141.0 /   946692911.0;
    % A(8,2) = 0.0;
    % A(8,3) = 0.0;
    A(8,4) =      61564180.0 /   158732637.0;
    A(8,5) =      22789713.0 /   633445777.0;
    A(8,6) =     545815736.0 /  2771057229.0;
    A(8,7) = -   180193667.0 /  1043307555.0;
    A(9,1) =      39632708.0 /   573591083.0;
    % A(9,2) = 0.0;
    % A(9,3) = 0.0;
    A(9,4) = -   433636366.0 /   683701615.0;
    A(9,5) = -   421739975.0 /  2616292301.0;
    A(9,6) =     100302831.0 /   723423059.0;
    A(9,7) =     790204164.0 /   839813087.0;
    A(9,8) =     800635310.0 /  3783071287.0;
    A(10,1) =    246121993.0 /  1340847787.0;
    % A(10,2) = 0.0;
    % A(10,3) = 0.0;
    A(10,4) = -37695042795.0 / 15268766246.0;
    A(10,5) = -  309121744.0 /  1061227803.0;
    A(10,6) = -   12992083.0 /   490766935.0;
    A(10,7) =   6005943493.0 /  2108947869.0;
    A(10,8) =    393006217.0 /  1396673457.0;
    A(10,9) =    123872331.0 /  1001029789.0;
    A(11,1) = - 1028468189.0 /   846180014.0;
    % A(11,2) = 0.0;
    % A(11,3) = 0.0;
    A(11,4) =   8478235783.0 /   508512852.0;
    A(11,5) =   1311729495.0 /  1432422823.0;
    A(11,6) = -10304129995.0 /  1701304382.0;
    A(11,7) = -48777925059.0 /  3047939560.0;
    A(11,8) =  15336726248.0 /  1032824649.0;
    A(11,9) = -45442868181.0 /  3398467696.0;
    A(11,10) =  3065993473.0 /   597172653.0;
    A(12,1) =    185892177.0 /   718116043.0;
    % A(12,2) = 0.0;
    % A(12,3) = 0.0;
    A(12,4) = - 3185094517.0 /   667107341.0;
    A(12,5) = -  477755414.0 /  1098053517.0;
    A(12,6) = -  703635378.0 /   230739211.0;
    A(12,7) =   5731566787.0 /  1027545527.0;
    A(12,8) =   5232866602.0 /   850066563.0;
    A(12,9) = - 4093664535.0 /   808688257.0;
    A(12,10) =  3962137247.0 /  1805957418.0;
    A(12,11) =    65686358.0 /   487910083.0;
    A(13,1) =    403863854.0 /   491063109.0;
    % A(13,2) = 0.0;
    % A(13,3) = 0.0;
    A(13,4) = - 5068492393.0 /   434740067.0;
    A(13,5) = -  411421997.0 /   543043805.0;
    A(13,6) =    652783627.0 /   914296604.0;
    A(13,7) =  11173962825.0 /   925320556.0;
    A(13,8) = -13158990841.0 /  6184727034.0;
    A(13,9) =   3936647629.0 /  1978049680.0;
    A(13,10) = - 160528059.0 /   685178525.0;
    A(13,11) =   248638103.0 /  1413531060.0;
    % A(13,12) = 0.0;

    % Weights b (8th order, FOXY C array) - Indices 1 to 13
    b = zeros(s, 1);
    b(1)  =       14005451.0 /   335480064.0;
    % b(2) = 0.0;
    % b(3) = 0.0;
    % b(4) = 0.0;
    % b(5) = 0.0;
    b(6)  = -     59238493.0 /  1068277825.0;
    b(7)  =      181606767.0 /   758867731.0;
    b(8)  =      561292985.0 /   797845732.0;
    b(9)  = -   1041891430.0 /  1371343529.0;
    b(10) =      760417239.0 /  1151165299.0;
    b(11) =      118820643.0 /   751138087.0;
    b(12) = -    528747749.0 /  2220607170.0;
    b(13) =              1.0 /           4.0;

    % Weights b_star (7th order, FOXY D array) - Indices 1 to 13
    b_star = zeros(s, 1);
    b_star(1) =   13451932.0 /   455176623.0;
    % b_star(2) = 0.0;
    % b_star(3) = 0.0;
    % b_star(4) = 0.0;
    % b_star(5) = 0.0;
    b_star(6) = -808719846.0 /   976000145.0;
    b_star(7) = 1757004468.0 /  5645159321.0;
    b_star(8) =  656045339.0 /   265891186.0;
    b_star(9) = -3867574721.0 /  1518517206.0;
    b_star(10) = 465885868.0 /   322736535.0;
    b_star(11) =  53011238.0 /   667516719.0;
    b_star(12) =         2.0 /          45.0;
    % b_star(13) = 0.0;

end